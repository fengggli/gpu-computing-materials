/*
 * Description:
 *
 * Author: Feng Li
 * e-mail: fengggli@yahoo.com
 */

#include "test_util.h"
#include "awnn/layer_conv.h"
#include "awnn/tensor.h"
#include "gtest/gtest.h"

namespace {

// The fixture for testing class Foo.
class LayerConvTest : public ::testing::Test {
protected:
  // You can remove any or all of the following functions if its body
  // is empty.

  LayerConvTest() {
    // You can do set-up work for each test here.
  }

  ~LayerConvTest() override {
    // You can do clean-up work that doesn't throw exceptions here.
  }

  // If the constructor and destructor are not enough for setting up
  // and cleaning up each test, you can define the following methods:

  void SetUp() override {
     // Code here will be called immediately after the constructor (right
     // before each test).
  }

  void TearDown() override {
     // Code here will be called immediately after each test (right
     // before the destructor).
  }
};

TEST_F(LayerConvTest, col2im_inner) {

  uint shape_cols[] = {27, 100};
  T cols_values[] = {-0.5801606529496699, 0.48961753760732074, 0.04593308136767601, -0.024384376355059856, 0.03294569095389131, 0.3453138369964239, 0.39904403245855286, -0.24768012970685446, -0.43884626909136665, 0.29299470747617906, 0.200052517555058, 0.6061538182250004, -0.3277966223052327, 0.5259441979727535, 0.3791038581366216, -0.2722914938719645, 0.1520651076708747, 0.6089591223114175, -0.28575288682505573, -0.3574203052736298, -0.37557163546946815, 0.3457038316789851, -0.3269279531713878, 0.25528626089958595, -0.13393237739236807, -0.020017848109544257, -0.2610144682506694, 0.6688549640972091, -0.10719421169968153, 0.5275948419192562, 0.3339001073483628, -0.4667132832466654, -0.15162691847571977, -0.46651265286655924, -0.6337199243604398, 0.46629349208451815, -0.10297314997045491, -0.40203333770675875, 0.1200951194958377, 0.8827781502025991, -0.5025903549503156, 0.699754197870413, -0.19454171805542575, -0.39627321639016055, 0.24845074668505857, 0.07544691889600363, -0.02923883408388191, -0.3396961421860031, -0.02648754598927141, 0.40642058059396413, -0.6361093979048958, -0.7279362916226081, 0.41679237872429015, 0.41336953697142165, -0.08586819320379208, 0.04428581185357142, -0.4446087091894616, 0.25434766413357235, -0.35888763635514564, -0.11728083700416368, 0.5436188284326502, -0.030443357110133806, 0.6818433572449821, -0.10297771962418571, -0.27016416410657135, 0.4455473129513962, -0.13157116119127152, -0.0946765766263798, 0.22428782694015387, -0.09692854063313903, -0.3690472369311774, 0.3023486997938773, 0.2703131114893414, 1.159492322140025, 1.1490826879171385, -0.2924350337226803, -0.8412032812595809, 0.1498587308456847, -0.02608569259062426, -0.010901945050366818, -0.24575476015818534, 0.04518432864590196, 0.6388650063145186, -0.16544626523022218, -0.21938295620543236, -0.6687594777979784, 0.4028834584771132, 0.24789896277449408, -0.18929014604867425, 0.07727795339253546, 0.07420253679550043, 0.4976618795050703, -0.5437882985301346, 0.17459987134584354, 0.4157006227692902, -0.09434133519765925, -0.359586000199598, 0.46315553349235855, -0.41374935977429744, -0.28128177804046645, -0.5790311817842486, -0.29335486675991423, 0.10989822869380227, 0.10256392229897168, -0.07967723935134763, -0.37612780311970495, -0.3418393602633998, -0.23718064941152275, 0.17072603790237623, 0.02780645168293913, 0.6500160961237372, -0.47742838486856853, 0.3565652652255785, 0.057695476511715166, -0.013485198755073875, -0.22695304822360163, -0.41028308744328634, -0.8125716671674182, 0.37003346449671054, -0.3093749652747597, 0.564799987957838, 0.3560867591517594, -0.6271255313605884, -0.02715552402921291, -0.07670509996535345, -0.07426765159007981, -0.2875362264060018, -0.15865274901348708, 0.0635309904138624, -0.09513044558406862, -0.6841733111360148, -0.22713854258052563, 0.14807150070570343, 0.1248034191011472, 1.0531117187490848, -0.6965568635185861, 0.0863517054424462, 0.2922928101709065, 0.2249288410174264, -0.44386644798369146, -0.10361316505746049, 0.09458242705419276, -0.11848080191709835, 0.008140986768080132, -0.17889695020169274, 0.23318204439496185, -0.2861633283284883, -0.3620155191494066, -0.13920672781858937, -0.3641507397098994, 0.28423123031285374, -0.19839999288515667, 0.060481268815226495, -0.20256485608981695, -0.10163712696119272, -0.07721291811550744, 0.39329232425073196, -0.28815622065539387, 0.4142744296870148, 0.09943434183457685, -0.36958190188873036, -0.920408129150338, -0.027285458601939268, 0.5910855685973079, 0.3986131994654782, -0.1420208913849553, -0.2443280784899197, 0.45771560707344655, -0.1741199419705953, 0.21073326504561812, 0.21637690575715957, -0.1846100145535829, 0.03614538700769663, 0.04696900444097752, -0.4727536812285502, -0.03260357768372744, 0.21511199403681341, -0.3362592320883537, 0.31875025845124744, 0.06413022060472194, 0.7863539369627266, -0.012838365064094238, 0.08442102669571096, -0.0696237148865033, 0.08090129410065793, 0.7863642183421029, -0.3016897655258203, 0.0932883710378082, -0.07368096033218066, 0.645347386028939, 0.1774349771267826, -0.5399249791902339, 0.8352207368344303, -0.30765302901603536, 0.1511255221209069, -0.3374542525973408, -0.25399543050940104, -0.28433976668569044, 0.19557470412258693, -0.1629524920217048, -0.8222688025407638, 1.365352196694024, 0.010106756771852106, -0.14351238739183136, 0.14333292964972977, 1.1082420725528006, 1.200996660982584, -0.3596405386572761, -1.1446037416025014, 0.6424555758842776, -0.10311871744127621, 1.788417585062608, -1.051608756181091, 1.146568190407376, 0.8737365722599305, -0.4243927696347229, 0.6980798479603341, 2.0825383947006397, -0.9675560859336442, -0.5472286212535535, -1.3390410113035045, 0.4804780663502473, -0.20507458447457966, 0.6038871697312543, -0.23873324965256554, 0.01823868819432615, -0.34673217730497263, 1.657324291175288, -0.29832651371835106, 1.2815324782516395, 1.3467608343692414, -0.8663879094989557, -0.471958651499284, -1.1680953098193163, -2.3453677860897777, 1.6584821545200634, -0.30831994518967065, -1.1652562045226702, 0.0800053950770897, 2.3887021866301064, -1.0540336960603862, 1.5101775177438999, -0.3407041336709661, -0.9081948265374314, 0.7186211147647412, -0.028619505769687133, 0.1791936878226812, -0.46172516498870875, 0.05927945322315805, 1.2369281028507786, -1.6906710609245932, -1.4851355657191159, 0.8959431454432097, 1.1140000800784253, -0.10801992353148973, 0.16700688354528154, -1.3487954471311752, 0.8258376538426216, -1.1718628418097117, -0.3520907564442336, 1.5536075999697736, 0.7209922669416551, 1.5740756751643576, -0.7416751933138538, -0.9566416318975021, 1.135198146230882, -0.08944880015479169, -0.6082904587712366, 0.659568403960164, -0.40136245070916554, -1.0250607106052694, 0.8461009555874669, 0.5837135623403021, 2.5965938543831504, 3.0191339203146206, -0.6370641390551637, -2.097752868323956, 0.629508099691616, -0.3329907004185468, -0.07985293600083129, -1.2340288299488216, 0.11378080567117586, 1.380427387058354, -0.31648199418205125, -0.5683798337926576, -2.196035779489794, 1.1752574110073455, 0.4836785206215279, -0.3672243995938213, -0.37832448873722385, 0.01641278097207756, 1.5953421586657786, -1.9537723949519663, 0.6612142749315405, 0.8156366430642504, 0.07517384952480448, -0.5997005624593994, 1.2974322431491454, -1.108862401315594, -0.49978687806098393, -2.9272650165400456, -1.3763321093513892, 0.5468448424511392, 0.501190974686516, -0.38744544978972706, -1.8031445985259067, -1.6271623496969372, -1.2004225628209242, 0.7800354652087401, 0.17668238762517252, 3.224673434320358, -2.265918695013036, 1.7093021330308003, 0.35543148954577136, -0.014704138313920059, -1.1534647835353178, -1.9974726445679465, -3.9141061559093666, 1.7812780618634234, -1.5704916763972512, 2.7271021489974316, 1.7986713017496452, -3.1293537271684793, -0.09881097501214532, -0.3955523535215258, -0.368048711244198, -1.4499375837905264, -0.6893224548910726, 0.2979102792838625, -0.39609428823545745, -3.3199745988222413, -1.1808552197763413, 0.7077137564079592, 0.5503743035856105, 5.093950324323024, -3.3628588407356537, 0.41074021601259075, 1.3830358047320799, 1.122780331515828, -2.0631545357582137, -0.5781200369149443, 0.5605492701318248, -0.6093012829335506, -0.013922302933726061, -0.8461578344826384, 1.1572972652985245, -1.411619149866452, -1.8270166894267503, -0.6883650677825527, -1.735907405378767, 1.3115024597070815, -1.0750658589611033, 0.3542695893630894, -0.9401202188807155, -0.5116471887158416, -0.37377906303872044, 1.8740540545023234, -1.3828009980372888, 1.988939227220781, 0.47314515211202685, -1.743938479447465, -4.531632809076407, -0.041358000651121656, 2.8935250224164166, 1.923984756011126, -0.6379222704009534, -1.2197680671674749, 2.2386088182996216, -0.8259504442338915, 1.0233962038443596, 1.0140978615391554, -0.8669201177698808, 0.21461263320493515, 0.38894987923569224, -2.16898322554446, -0.2002032251369305, 0.9435735923691045, -1.6336498481098063, 1.5643796724828136, 0.3139717804270315, 3.834605379905002, -0.056998325671157216, 0.5022729499979062, -0.36501085206510026, 0.3680759838138391, 3.777047624312899, -1.429143643278947, 0.49264637463535005, -0.38821569848264037, 3.1849875837594563, 0.8829080200692344, -2.588114729498221, 4.0343924189653375, -1.4895665043800215, 0.7999999071335855, -1.6727853657527734, -1.2983747361116849, -1.3355906576446648, 0.9056839400502068, -0.8398704761819599, 2.3459562805780174, -1.9939043305562232, -0.18458393259032782, 0.10088481299506244, -0.13524555961987642, -1.409291157977228, -1.6269042439749855, 1.0017075846693997, 1.7854857348321564, -1.1895241726416093, -0.8008354596269489, -2.470539063175479, 1.3377914117197711, -2.1351317937682275, -1.540007248566259, 1.101852894307575, -0.6250085328962519, -2.4879633921407387, 1.167269315011352, 1.4461282186745188, 1.5355807776539465, -1.3977002023566212, 1.3165633925334779, -1.0373568537467006, 0.5425982857449607, 0.07996798054586923, 1.054960143734875, -2.719469612945359, 0.4365221172907177, -2.14458587568749, -1.3684760171745585, 1.8915112373974103, 0.6185107368196173, 1.8970289553070265, 2.592859737647399, -1.906426543668538, 0.41978851324104066, 1.6381540717834282, -0.48372997754121316, -3.593469915062447, 2.0394518376273343, -2.840413109587482, 0.7880169216365748, 1.6096459898876252, -1.012324123162646, -0.30223877055032006, 0.1136071471073872, 1.3731927502137637, 0.10507677548973825, -1.6572662166335104, 2.5887301053444274, 2.9530092117808193, -1.691751682783348, -1.6825825685723854, 0.3469326454405263, -0.18126014497195403, 1.8128951077921245, -1.038240921221949, 1.4651087552578463, 0.47813587785892603, -2.2146070327388814, 0.10708727106190351, -2.769859415655088, 0.42888889975178623, 1.1044685515383426, -1.8121861302666338, 0.5299919025153875, 0.3927732913575331, -0.914098285233184, 0.3974758201311473, 1.502812062835873, -1.2313383310251595, -1.0972507743110191, -4.708537801766212, -4.675609655727362, 1.1871646909615245, 3.420493777990073, -0.6147152006440276, 0.11168476776520124, 0.04543314990096229, 1.012304284212778, -0.18375124171389123, -2.5932889884583576, 0.6707222087315574, 0.8924993983118501, 2.7303763857813594, -1.6417759963870646, -1.005185491506128, 0.7674932838551702, -0.30225946923183517, -0.2981876736632196, -2.03101376202572, 2.2236737288503896, -0.7146888604190624, -1.6856864282386521, 0.3771039503000633, 1.4559208449108283, -1.8862642962857645, 1.6839994773544362, 1.1395193275591047, -0.20834861408516742, 0.16578482748221973, 0.017318594861756766, -0.0071264934352894115, 0.010385325190022374, 0.1147491196568304, 0.13379637728352786, -0.08881874519471696, -0.14977838699617124, 0.10182099623329405, 0.07762965532343634, 0.20377614595382582, -0.10893427693525913, 0.18287516152244823, 0.13110996110547277, -0.09721022312120556, 0.047388466941472224, 0.20044154680395904, -0.09420153472496524, -0.12774922559871904, -0.12280321437964681, 0.12429199870857294, -0.12127236273428017, 0.08805642869291586, -0.04736616834978459, -0.007886381939403444, -0.09408340238149399, 0.22958525358316914, -0.03630495586788823, 0.18148320093248554, 0.10683865014394954, -0.16454064591908085, -0.050605735766023674, -0.15994925811883276, -0.2059256162149355, 0.15252721576988748, -0.0345499962184253, -0.1354681667307185, 0.04447878779942287, 0.30000204927700436, -0.17537772411266236, 0.24353930253559222, -0.06889186565295125, -0.13712435475114768, 0.08373965549888839, 0.02912320876783074, -0.013802130286408944, -0.12228771821995671, -0.010961197453738355, 0.1360642006125162, -0.21663201289739067, -0.2546326239258422, 0.14511180661839498, 0.14054674474385095, -0.03104193525574132, 0.014344058580630044, -0.1489142808418353, 0.08437793855629248, -0.11895958544750002, -0.03933663995549118, 0.18350601219955243, -0.022368319686266083, 0.23577098546934633, -0.028066529395165487, -0.08843597280265113, 0.15246776741355114, -0.048702177877823404, -0.026905450906583066, 0.07543344166631251, -0.030858644421405054, -0.12502052033150987, 0.10233104992049812, 0.09407352834750385, 0.4021343213198395, 0.3918518446286007, -0.10168881751122519, -0.2885438613644614, 0.047575493235790016, -0.004937997301682884, -0.0029513567666974213, -0.0750011559922232, 0.01548232731608605, 0.22232288806011563, -0.05818840620380501, -0.07493260604738032, -0.22148706551394173, 0.13564182622583848, 0.08704573366404736, -0.06649764371994481, 0.03505298088021883, 0.027976017123607057, 0.16540252923663842, -0.17758196083834524, 0.056510866862732864, 0.14589837122432886, -0.037006059712774125, -0.12778766188576013, 0.15673689633051402, -0.14076808957723394, -0.09950123993539735, -2.556839263095768, -0.10305147428737307, 0.3876176570888176, 0.2594116089288127, -0.18021731091092394, -0.5619393275501834, -0.3810484088620448, -1.0625962750536617, -0.1742157865177981, 0.5262404163333275, 2.183648894658841, -0.4578836218974506, 0.532039043529861, 0.9671307357763118, 0.5378966726594125, -1.0704789341167946, -0.9547508914094981, -1.42253055057927, 0.6349543028002037, -1.4383054340201917, 1.0613565746869922, 1.555522555174753, -2.3105377293935874, 0.3099616192697009, -0.425563376983615, -0.24517264190658214, -1.2284676205144223, 0.5591249203475736, 0.020553596147544533, 0.5278152425167227, -1.4698823839131872, -1.366867206772123, 0.19735104991211813, -0.3490803310643816, 2.080265149344491, -1.3042205845070585, 0.09295260677418973, 0.2332580565427367, 0.8330293446085436, 0.06008535521853174, -1.064343452485222, 1.3382597306486694, -0.6385683392148267, -0.5794736976580975, -0.13913194545930668, 0.7889485127047392, -0.8718050898640244, -1.5635209805532195, -0.44275966670963235, -0.4343268006398372, -0.1462423457358141, -1.6812861804358579, 0.8090880719545795, 0.04340020144781404, -0.42450373850088124, -0.15583655351578024, 0.46046561292594756, -0.44603253693374384, 0.6515678313284758, 0.1090031200523887, -0.24125372898288386, -2.707271027696199, 0.9586787006716204, 1.5521561551394016, 0.7413011151427651, 0.2674007723487227, -0.9065766113431142, 1.179208880656591, -0.16209013898340838, 0.461743925885923, 0.06397644222217058, -0.0736320806659925, 0.5158340629069644, 1.9001913373297155, 0.3818070500717518, -0.5392574876984351, -0.6581612127826013, -0.744101720959485, 0.8818280773201478, 0.16881412185607605, 1.8994225539165615, 0.0316407302825918, 1.2162274245520692, -0.45304548519273946, -0.0999458204886149, 1.2557652105273416, -0.2591314877598279, 0.6469295972982956, -0.5010584598505239, 1.9833251402673049, 0.6258874121027973, -0.8036567450637335, 1.587180692528928, -0.6237511368240343, 1.069483753588778, -1.1191562799299661, -1.2814960085859823, -0.11725565615667537, -0.06418705274726391, -0.8991307005194444, 0.5411898482370848, -0.3545662055357649, -0.0512156958550779, 0.006168169024362632, -0.01602803437419627, -0.22795737791570925, -0.2755521914097668, 0.22973419894626407, 0.3298453408286905, -0.23874401920134472, -0.24544835955682567, -0.42403261180736024, 0.21645645910230066, -0.42957727150128294, -0.30244734297395504, 0.24814727532329736, -0.06842436137317993, -0.3825007856701017, 0.18095930195733465, 0.3272258009322678, 0.2275894975894859, -0.32392640604644546, 0.3442681892821553, -0.20130495949722121, 0.11749373868158267, 0.025765454080279512, 0.24701266164901023, -0.5159913366252555, 0.07771753822028352, -0.4109367297372106, -0.1785556323334314, 0.40418381169993256, 0.10232790724247907, 0.358045326448322, 0.3709458942718987, -0.2831759287726794, 0.07134909417209362, 0.2844236691046763, -0.12575399745753724, -0.650392239440801, 0.41683581553748555, -0.573868688995007, 0.1715868016599687, 0.3169229301614582, -0.1759964418131212, -0.09100457812242692, 0.060846691567156164, 0.3198801104895179, 0.03944061724449542, -0.27855670152438267, 0.4733094042185873, 0.6100458640435935, -0.34235314885860973, -0.30524232415125674, 0.08218210070144058, -0.02544976662865804, 0.3053934388055033, -0.16645481205413842, 0.23386611832074258, 0.08112108216297614, -0.38794088041206487, 0.14467061982115473, -0.5435755206463299, 0.0054146259875709245, 0.16471660881555247, -0.33897256656614094, 0.1374971658313077, 0.016176809528877456, -0.1572311540317231, 0.05024950904121137, 0.26787182958844935, -0.21850009779140975, -0.221632736596055, -0.9365619016406238, -0.8603125028751869, 0.2389216069244101, 0.646915145699294, -0.0763243038072527, -0.020709078374854833, 0.00037024955327825997, 0.09447524415977268, -0.03458062842946269, -0.5236811355402181, 0.14185671311898138, 0.16547330671792515, 0.4339108571410127, -0.2838782294052799, -0.21111179726705748, 0.1615200922171827, -0.14631891584426657, -0.08272326897403581, -0.32880955273602464, 0.3272460868441769, -0.0999147435808308, -0.35331878944636097, 0.1197883204241503, 0.32172889669179683, -0.3345096966089274, 0.30646029944683884, 0.24700046625234945, -0.018553866800034954, 1.0462724255341105, -0.08294782157143307, -0.16802097621921136, 0.1493935668234754, 0.9609370595797668, 0.9881395899691665, -0.021122623760101083, -0.8162569873077192, 0.3581069746841845, -0.5871173427674082, 1.445870545593942, -0.911554810540709, 0.6325702220972412, 0.5285399248621051, -0.06776043837466253, 0.7455852392683006, 1.8913316456966047, -0.8726587267434823, -0.07383187636714766, -1.2503524134730561, -0.003514708589659891, 0.3860104169443796, 0.3797360146685933, -0.07935877870227881, 0.07090637406495284, 0.027275015769922088, 1.110237245744894, -0.2281498977986877, 0.8362016777580085, 1.3515289592403232, -0.329461124780283, -0.39942920988444774, -0.7930111067190996, -2.241696946574627, 1.5462231653206138, -0.25253800648615876, -0.9268702587191016, -0.13462658212142828, 1.7743365686976023, -0.5405911115251437, 0.8181321435019958, -0.10596223189052471, -0.5446291845026923, 0.5705047953821402, -0.20565805923710279, 0.33773780027837536, 0.019422334452852158, 0.14777219472429864, 1.0274819508755892, -1.2316174778223725, -0.7192819912434735, 0.4818382357453331, 0.8238921131379489, 0.018255896048546705, 0.16142445000583064, -1.1173383096808995, 0.7224412773302037, -1.0294980897648005, -0.289056259658367, 1.2194872899341553, 1.1719789218520802, 0.9546091008729035, -0.91772715712752, -0.8893208931862348, 0.7874551420415515, 0.14473090508504277, -0.7307762494009189, 0.5316544456906291, -0.40831512038033335, -0.7823792679613893, 0.6506508757393146, 0.3165581945626616, 1.5002880896581132, 2.171199745514484, -0.3510308467352365, -1.4168497220342366, 0.6450573865811798, -0.4552226689062689, -0.0992047134972108, -1.3674331088179366, 0.07779653650282069, 0.7494875192225924, -0.13115002498617429, -0.40219430501216397, -1.937362373364574, 0.9403997695088658, 0.2110514486515845, -0.15792797040295534, -0.7463790967444359, -0.13386619623992502, 1.3820625303286096, -1.8333757203205576, 0.6406914221669693, 0.3609082829546727, 0.3176206993429083, -0.1497337810138964, 0.998739178703421, -0.8151916082636291, -0.16421868133760634, -1.7775808303695202, 1.9743577722731647, 0.1018954454166123, -0.15166177594875785, 0.16919654220535085, 1.4950787392402178, 1.6714306945256066, -0.764952732761457, -1.713711972283873, 1.0581773136091575, 0.3398676866280899, 2.5135630335680497, -1.4189434215524157, 1.894777537751276, 1.3991619756012061, -0.8614570104746615, 0.8067330909790866, 2.7270782716703255, -1.272845861754114, -1.1238279752409164, -1.7205047347813858, 1.0525137811804512, -0.8192715901112527, 0.953147282012706, -0.4449045808950091, -0.028414299124698242, -0.7833439649319632, 2.550325007627858, -0.4318340485699808, 1.9935036524165286, 1.6399909736009504, -1.5747051783860824, -0.6461270143251993, -1.7873775070136129, -2.963786349020319, 2.133269822031126, -0.43018427387308333, -1.6523551303879405, 0.30425472399576803, 3.5081851806856887, -1.7812457379137696, 2.510143366573007, -0.6419569992964993, -1.4589181529588584, 1.0200788892716202, 0.13542972392330838, 0.06624065571339285, -1.0268756848244551, -0.01277515243317929, 1.7120253192097252, -2.506324491813554, -2.550595120119573, 1.4925950654438382, 1.6395405236172593, -0.2534322551858147, 0.20931072613022847, -1.869813586682169, 1.107967486726427, -1.5680140253208654, -0.49061414313137414, 2.2187181312011397, 0.44641067560400094, 2.518323517893699, -0.7362585527385124, -1.2329786744715212, 1.7208929806186164, -0.33459872667676777, -0.6249284194308891, 0.9285251147240039, -0.4834275085261208, -1.48529109477904, 1.2213022463145133, 0.9698988622956969, 4.2258581737351815, 4.5028101197530805, -1.0532149399134805, -3.216930428546574, 0.7537514425540236, -0.2889939246092057, -0.07888765708994334, -1.3785330866157752, 0.17357245162764956, 2.2928940444289228, -0.5648273963735431, -0.8540030920839485, -2.9306025952474664, 1.6611724117884792, 0.8530082040796566, -0.6498537105270684, -0.10777831898589647, 0.1646674869809002, 2.15338729948067, -2.501691242547788, 0.8271840769189247, 1.4336249384990287, -0.1415280109050035, -1.1653549240915182, 1.8717984678116593, -1.6366954997321488, -0.9332518921828832, -0.39624840599424344, 0.1120917889595785, 0.04958190656431062, 0.019421454169662497, -0.00949687848320685, 0.03094506215655779, 0.062145413150255076, -0.16631720547218007, -0.12668197455011962, 0.12488798787083004, 0.26466376828554755, 0.10629161874578134, -0.029512345359734536, 0.22639395973274723, 0.1475299364199199, -0.17323615738656137, -0.05592254661154779, 0.012135670132366577, -0.00889688020381154, -0.23065652871084763, 0.010610567191417264, 0.23925796546716865, -0.30881348120659985, 0.09420742533313786, -0.07528081086351537, -0.029105597493793784, -0.18595646953802664, 0.22194904839083188, -0.024738214665168727, 0.18360697852271993, -0.06118459893791554, -0.2509150480339418, -0.018445167592599402, -0.15078332690403715, 0.04635995351603882, -0.011844772452268068, -0.016565311321585275, -0.07742425556992935, 0.11189375386897762, 0.2262796546336413, -0.23012322995545928, 0.3062769001700332, -0.111356286959754, -0.15590436662313106, 0.048340508561299, 0.09641346870012338, -0.09302587001185514, -0.23854474885251187, -0.05014990034446079, 0.05874784606572382, -0.173174826752896, -0.3470427897522002, 0.18360522409836869, 0.10745868238774091, -0.06317816668390573, -0.004268577047689526, -0.06571059792789358, 0.019634243453830837, -0.025520137448295614, -0.01855870544998368, 0.11198255087359212, -0.27381271070287466, 0.26448055583871355, 0.12692083719003033, 0.0054519519244167584, 0.137517904505288, -0.12199065678261041, 0.0923202056207874, 0.04005108694484933, 0.021207839653384977, -0.08583571083735154, 0.06823603437200462, 0.1182026099627772, 0.47629929630747186, 0.324394013679177, -0.1260282769237067, -0.2747115185317817, -0.035759650823415465, 0.08020058211499684, 0.013878438249037171, 0.125426465770203, 0.014390853249624753, 0.27907714227478514, -0.0858501312439703, -0.06459334425615915, -0.04346233354561108, 0.07509227254048158, 0.12549824548957805, -0.09652361189619166, 0.21431672457378637, 0.08006860566565029, 0.0452075861197342, 0.020323650993350706, -0.017749038051905915, 0.20893807112204363, -0.1336003451613954, -0.2157776798386451, 0.10408924285792961, -0.10959752429731827, -0.15863131806460196, -0.4022076331673133, 1.5920677973467094, -0.07075800336966925, -0.22017348111611143, 0.20313584199092868, 1.393917059633912, 1.4621406226722353, -0.18775465796582588, -1.2792773260312444, 0.6269866213975352, -0.5826809415549332, 2.1540093494361074, -1.3224335407452308, 1.1130172717601463, 0.8904843315764246, -0.26054493952437874, 1.005711885640877, 2.6972682694204395, -1.2476449919516048, -0.32363255182911, -1.765479477957221, 0.2219565718087925, 0.25522397506272115, 0.6285986382740932, -0.18409967425368634, 0.07308148209950567, -0.13765709689532798, 1.7871049217948805, -0.34744620036234974, 1.3615955619325262, 1.8611818284715116, -0.7058511855309061, -0.5846995519292923, -1.2691286446586059, -3.1393133498896453, 2.1844555789319777, -0.3743257784078208, -1.3896287420002125, -0.08503789237732239, 2.734256946185634, -0.9859411120845014, 1.4522944579069115, -0.25609681519584354, -0.9212751884087557, 0.8559900150429868, -0.20058885938337656, 0.3913600044652439, -0.19869066742786892, 0.1622721086347057, 1.5147853952599843, -1.9132044183067054, -1.350592177247749, 0.8583854309047275, 1.2718852628352568, -0.034003491378608294, 0.2251794094307163, -1.6489890656891855, 1.044515866811818, -1.4861303180037169, -0.4280738029440592, 1.837935338295568, 1.4045266073890617, 1.606450680837655, -1.1828141608969187, -1.2576952993814132, 1.2486560954892119, 0.089808990439926, -0.9501576887933458, 0.7929582499051558, -0.5597050884288379, -1.1924251536474952, 0.9886721031916603, 0.561644502672443, 2.582254075890246, 3.3908826658148565, -0.618019891015878, -2.2725530662624505, 0.8820842904271815, -0.5703580187839891, -0.1277097987695284, -1.82282980467344, 0.1241242095777727, 1.3290164270009186, -0.2676705572395668, -0.6323998281123007, -2.7923483436809917, 1.4066291229356618, 0.4187414956722763, -0.3158204801687697, -0.8565947657757108, -0.1141457873884006, 2.005458623136881, -2.584179618012575, 0.8929683928518085, 0.7106900859167518, 0.32430619533662325, -0.4173026108331821, 1.5169781300410894, -1.2615590354393353, -0.3836656281605846, 6.782268858918045, -1.577480729081401, -0.8765937284134372, -0.38777386217814586, 0.21164700720903865, -0.21527301207012417, -0.7408700283889971, 2.842349951645976, 1.9028007937437177, -2.022185958660237, -4.726476634674902, -1.3471812114547186, 0.20690910593055378, -3.671208783278648, -2.3542329512700717, 2.9456008041473485, 1.2023406475742402, 0.41181711044474334, -0.13352089082359975, 3.9273112198539826, -0.5914699964859667, -4.1000107749806585, 5.416934173060159, -1.4894934106718474, 1.2636738092204025, 0.5218573325079132, 3.1946590603796032, -3.438546634586058, 0.3490475506349549, -2.8714790449713083, 1.4910332477334203, 4.190610684239646, 0.18511597762051452, 2.323311071057193, -1.5287394904165779, 0.7095598209830849, 0.20104198354651143, 1.0226959484072884, -1.9610253149137487, -3.295135662519383, 3.765235128580791, -4.978925323334433, 1.8729855570514247, 2.492428038302575, -0.6412142370074791, -1.719098484748344, 1.704341358025489, 4.093004615613912, 0.9075649069258315, -0.6697734007120213, 2.5631969092343048, 5.709697650206068, -2.987560874031478, -1.5709743059522583, 1.088321532697774, 0.12602019282098564, 0.7596134844651576, -0.09964749581397479, 0.09987072672885755, 0.22322621885239727, -1.5188531623379462, 5.074849832706501, -4.218170790168942, -2.475055799565934, -0.38479816601774375, -2.09787434635799, 2.1373116995210424, -1.8210364996431094, -0.5119334518452301, -0.49711297509050173, 1.2141415824199615, -0.9557944500074016, -1.921269100582676, -7.668154582188334, -4.845948950587162, 2.0440394616587056, 4.241983736078222, 0.8239797610233023, -1.5231198092858045, -0.2702648613272578, -2.596807028810366, -0.22104651429660918, -4.535443708707903, 1.4277725311970781, 0.9747996253045347, 0.10977452431900252, -0.9783123472326085, -2.0808253107733465, 1.6018516198064754, -3.916138105242002, -1.4155621350388905, -0.3216247649971924, -0.9489054749918526, 0.5139995316117015, -3.46117604320444, 2.3928532600035393, 3.647543251299168, -1.4559596318396961, 1.6104668130298578, 2.66379148605901, -0.8744497211398352, -2.355834209033325, 0.3226445549857479, 0.46528964952005064, -0.395645827667396, -2.331020961207878, -2.3265372198526535, -0.3336867243140958, 1.7467476560987962, -0.6052595025377573, 2.083209877471865, -3.3685547082120197, 2.2108644283610848, -1.055695880176286, -0.9788289909375304, -0.233142487079107, -1.9943813144470761, -4.701291823425617, 2.1615087569059095, -0.3513999541521757, 3.1513091660905483, 0.5648030251613251, -1.6829186756884862, -0.7306443046210555, 0.023499961977646474, -0.24494841072450377, -0.5003505237080011, -2.260487222706444, 0.5130258720521641, -1.6643330544351185, -3.521842369197195, 0.24075163054582613, 0.9559541255391808, 1.632609252023988, 5.7133594663833955, -3.894036462656324, 0.593004260615193, 2.137819492630627, 0.5966804404540977, -3.9110806248444843, 0.8170249613552746, -1.33407417510534, 0.00618880440671545, 0.9996006238728489, -1.3142743635305474, 0.7383280867156368, -1.0607363146089328, -0.6029244361845683, -0.48606538155949547, -2.4328129957844227, 2.6773594880207363, 0.9921516328374964, -0.7782102649416278, -1.8105133831012554, -0.19247138687833498, -0.4135803413540588, 2.6413284257558693, -1.7609199397868398, 2.5150728044589483, 0.6796899166116667, -2.789231917068348, -3.566985379513216, -1.7724815900456337, 2.5898358059502637, 2.236519836760571, -1.6495435721535276, -0.645411769683606, 2.041934619076397, -1.2363884339812239, 1.0703244131995544, 1.7569555511167796, -1.4684535078985879, -0.516898180926228, -2.6447673729120065, -4.67547401977166, 0.5849148946367781, 2.904592007642741, -1.6961430005798617, 1.324716027428393, 0.2803251343184649, 3.7109048852993283, -0.1610962037379484, -1.2256301363279698, 0.12844782305176003, 0.8556243359356647, 4.743596633286137, -2.177070922537409, -0.23611192809930978, 0.17060496647550746, 2.3644603342628705, 0.520820212568389, -3.3509491914810137, 4.631798869364986, -1.643370349000902, -0.4169396308752641, -1.1047226188886574, -0.12702133004835167, -2.255569015605756, 1.783786284961386, 0.04200287033405641, 3.3588250887260798, 0.814442949584321, -0.564820890159035, -0.45097403064180425, 0.33448547573379317, 1.3640805143490564, 1.1432422656571493, 1.387194854943783, -0.2997206994983643, -0.46152108339313763, -3.2596437436115147, 1.5414109576165411, -1.2926329493130575, -0.864768194778048, -0.3663502888104857, 1.367339128792405, 1.74228008510746, 3.1020855502998343, -1.4030863640379685, 1.8483325604976795, -2.2102036298325634, -2.053032856820497, 3.2964977696685143, -0.1623577480526267, 0.5095798428349574, 0.3692159968681596, 1.6372639144912913, -0.017064342971284837, -0.17506887641769495, -0.15351842943877658, 2.814411828502329, 1.5883566057792569, -0.519240199624935, -0.05410800918917571, -4.196459846769115, 2.722281602118439, -0.2863349609516348, -0.908662414576732, -1.185555422023642, 1.07157039404579, 1.052585543685135, -1.2337030258727584, 0.7731448080988064, 0.41072912176943693, 0.553440756038363, -1.173509632728953, 1.3684084344439131, 2.073894977318726, 0.6795617033909942, 1.2389992215289238, -0.6059912278352443, 1.7500500405099213, -0.7541701369879125, 0.4771358911234797, 0.5714929965747294, 0.31014552603114837, -1.3317381532989017, 1.0565908541623958, -1.526710756961125, -0.33118018421212636, 1.108986889025745, 4.329296000439265, -0.644759878089188, -2.6415273302353275, -1.5540973609394677, 0.15818839547453897, 1.2890712682201475, -2.0285939296888786, 0.5585108849960838, -0.8735708261289794, -0.5917739001932312, 0.5190682463287639, -0.47474904267828094, -1.532109179668707, 0.90481672085644, 0.4832717705036273, -0.0512295200765266, 1.3993671132877588, -1.4578198350971676, -0.2869007734323257, -3.391019425177086, 0.0087424881976147, -1.1173403534407413, 0.5122210587216242, -0.12908647068770904, -2.9120814743400403, 0.9515480165941359, -0.716010107149874, 0.5581524679453688, -3.098835759215092, -0.911972674745459, 1.9558835629182705, -3.2815666640401027, 1.237868945199925, -1.1758996178567287, 1.6814612816990149, 1.5923719615685001, 0.8023405732714267, -0.44408823856076757, 1.0788787440165652, 0.9699755556437957, -1.962123931088497, 0.016869572476916117, 0.22633252404542825, -0.21967423953932358, -1.6312971625015817, -1.7494053916813308, 0.4287465732404596, 1.6238246881210143, -0.8768047734756181, 0.3240710910796507, -2.5962047775411743, 1.5478390043704413, -1.5625423739813213, -1.2068214411728655, 0.5207686547688326, -1.0761145183037357, -3.095061226810709, 1.4358800828810951, 0.6668121255690448, 2.0019354323628153, -0.5618183342361774, 0.10669112551404202, -0.8390964750270269, 0.30722350268899273, -0.0459171796553695, 0.3968671264823563, -2.3264051928924423, 0.4285611833882631, -1.791184828956762, -2.0460045754027725, 1.1292977668839255, 0.6913165992552669, 1.6433059305182691, 3.524331696921802, -2.478681200642506, 0.44871380373185016, 1.6863151689417422, -0.04715029964088824, -3.4133322606799967, 1.4222692458411021, -2.0528613332545795, 0.4359242194571514, 1.2527697920198497, -1.0395800669139732, 0.10472677596368088, -0.32689319056022526, 0.5343367417501305, -0.1206172432023826, -1.8051292602652336, 2.407498196514373, 1.9892990264453885, -1.2166775257306977, -1.5906055768953813, 0.12026077830096005, -0.2515804734986551, 1.967322251936621, -1.2178125557770405, 1.7295822272164274, 0.5126464389521974, -2.242685220660646, -1.2505625905518531, -2.1749809619826213, 1.1867885011979242, 1.4288579919110957, -1.6028330653389748, 0.05471862015812149, 0.9657710760761968, -0.9569324896273671, 0.6116663005209372, 1.472014503691047, -1.2167068597369832, -0.7935871999782069, -3.5620808183894717, -4.289462923092084, 0.8680375218566004, 2.9486450629501637, -0.9609622738821003, 0.5477840857396095, 0.1279137804318862, 1.9194080036038101, -0.16026064725030148, -1.8770554633577567, 0.4162590821744573, 0.805262257388586, 3.24399382574631, -1.7027181300231071, -0.6398420883774257, 0.48498952054352196, 0.7016928169605373, 0.027105739304459572, -2.3478671280009586, 2.9241085422326587, -0.996604975657784, -1.0807119213458127, -0.19803675379938954, 0.7545738322532389, -1.8660798818758912, 1.5815733966426608, 0.6425067734621569, 0.5176518127819979, -0.09873838005002315, -0.06867968161648132, -0.03311167862448166, 0.019271652313360227, 0.0035345456005968397, -0.03604563673905294, 0.21666284813439501, 0.12836859580385257, -0.14701205675999482, -0.3732195933927158, -0.07284041388098828, -0.00314676092215451, -0.2672603884591844, -0.16883098371045052, 0.22357969339662181, 0.10733647141751142, 0.07077480035138806, -0.028340569736925916, 0.29843764821847757, -0.07117129366742335, -0.31323663241578736, 0.4217766373388016, -0.10587472831052847, 0.09487104177084558, 0.041334170539377456, 0.2445787852282178, -0.23955895269979238, 0.021917545979789572, -0.20194272162972124, 0.14198437903669678, 0.313234375805182, 0.005835461225469886, 0.16097092592700918, -0.16337052295638263, 0.08634211942346419, 0.010105694416659768, 0.05884558169745768, -0.15258419275108695, -0.2147988011640153, 0.27635442399677246, -0.3632875606492879, 0.14085790657940292, 0.17905199748231848, -0.03711620733408535, -0.1355822466525952, 0.1372009446281382, 0.3130322045593227, 0.07239295871554165, -0.02979728830437576, 0.170175301030263, 0.4211598356248445, -0.21817620487804232, -0.10286457497544127, 0.08350678695363825, 0.01298149259744221, 0.034791314040196086, 0.007407961518044792, -0.013774451283688014, 0.011040957780963858, -0.09065929799469262, 0.41198768809535774, -0.3023429697334008, -0.20812666104546176, -0.047879815728275724, -0.14386731365255495, 0.16625921389250317, -0.15428530529249956, -0.028049268652671315, -0.04645870813963946, 0.07647230793801733, -0.05947801528453321, -0.14016768649300085, -0.5545123579989768, -0.3250011484323433, 0.14882836135244898, 0.2945521045760877, 0.07634691126582867, -0.12580147829521537, -0.022705553432373186, -0.2267752973989624, -0.015266441606677077, -0.33084100572516345, 0.10632838067917454, 0.066094926507013, -0.03189198143867261, -0.055174239915108635, -0.1545482008959217, 0.1190680441477346, -0.31463596288357737, -0.11090527638767794, 0.004166240127180715, -0.11059335917314199, 0.05257949696005249, -0.25686554559014385, 0.18937205644141755, 0.27549068890740824, -0.09044464790768691, 0.10606193698742776, 0.20004945860402273, -0.5463680366502022, -0.129315138338378, 0.09161795215714272, 0.07284434831042365, -0.05395366155820433, -0.21897078808029957, -0.1829695014409664, -0.22569058688776913, 0.04628902922853873, 0.07614574978822619, 0.5284105183895919, -0.24635179096384935, 0.2074987131014736, 0.14256112155860196, 0.06117998446529802, -0.22260163970008948, -0.2811340016344209, -0.4988523767166511, 0.22558118079718092, -0.3008534093550126, 0.35572011860574276, 0.3339147157998517, -0.5350110206631259, 0.02755210097074477, -0.08312225527532587, -0.05983915931824018, -0.26621837379464036, 0.0061221382169936705, 0.027787191294878215, 0.027490328250983534, -0.4536894597303073, -0.25933893375021855, 0.08325028269659555, 0.006410253903756545, 0.675795979771153, -0.43811762658574505, 0.045811079794767236, 0.14499983023012233, 0.19242450038140554, -0.1689422274396586, -0.17283231325286286, 0.20312763065858086, -0.12607122647606378, -0.06844668960350674, -0.08829731603254336, 0.19025114293253015, -0.22155325452793964, -0.3372599838706699, -0.11008511601847418, -0.1984257566950435, 0.09485182286737721, -0.28681338343622903, 0.12411801684057158, -0.07512255350752488, -0.09289817182071823, -0.04995850936463556, 0.2132388649344726, -0.16967657347433607, 0.2452158928082279, 0.052995066544807366, -0.17670051306378273, -0.7006262372123069, 0.10774755372498784, 0.42687746073504507, 0.25009285850386387, -0.023355651741799915, -0.20923087055578543, 0.327747520232593, -0.08923907927675893, 0.14085529047983714, 0.09389353228230357, -0.08246504830362092, 0.07817203231130268, 0.2537195677076969, -0.14062350327919493, -0.07966216410131492, 0.004061609830641837, -0.22566231219747954, 0.2357418590346299, 0.04636530695465095, 0.5474266090033147, -0.0011874588314492822, 0.18399435152630056, -0.08370796457694495, 0.0197835357126575, 0.4678095065135052, -0.15193438081481228, 0.11709505492361838, -0.09125941515706669, 0.5017750693663239, 0.14792862307154594, -0.3139580012603846, 0.5282196361342115, -0.19940783369826745, 0.1923476941371293, -0.27253186603354634, -0.2594502720218918, -0.12748997080720012, 0.06977358684209452, -0.17597438354605396, -1.0801186261836029, 0.8110243692054991, 0.09375018793173735, -0.029085296392588226, 0.046867992202285796, 0.5502392064184178, 0.647786117457305, -0.4598327398924508, -0.7387776279096084, 0.5114698002873358, 0.4303401108749064, 0.9893738822699238, -0.5223884398704421, 0.9191211586778785, 0.6554289571374583, -0.5011809126709256, 0.2108592309730509, 0.9511556736498034, -0.4477759166510118, -0.6593434874226164, -0.5784370475420731, 0.6450379991440096, -0.647331477482382, 0.43903850833203395, -0.24202686838511978, -0.04424695268176121, -0.4894202925478819, 1.1390410974768685, -0.17765056177176725, 0.9023374321933094, 0.4908561244140579, -0.8382276866665247, -0.24380571730982345, -0.7926394110904332, -0.9631573049754995, 0.7187632774891526, -0.16740001250170702, -0.6593369436349719, 0.23709396473380026, 1.4732060870933428, -0.8845406454745885, 1.2251559636573688, -0.3524609734560195, -0.685878373514844, 0.40768374965921683, 0.1607588827903936, -0.08746938487080086, -0.6353860075183598, -0.06380954695871384, 0.6577050655731861, -1.0661353528509414, -1.2873538350690668, 0.7302686465233564, 0.6905219308921394, -0.16191429077178385, 0.06684244630553349, -0.7201567498041405, 0.40386106906825325, -0.5688653118515415, -0.19052014339106477, 0.8948349670407354, -0.17108657830377144, 1.1784426428855181, -0.10252676045364569, -0.4170796554759016, 0.754083549921405, -0.25948093661356336, -0.10528112198932214, 0.3664122903904256, -0.14093324063528012, -0.6119154005281305, 0.5003794559896091, 0.47322402961290255, 2.0159743941843655, 1.9311217647409604, -0.5111162747561098, -1.4305429137808405, 0.216549978730938, -0.004244724057374688, -0.010654476240202547, -0.32492460779927473, 0.07667503888740866, 1.1183006178415216, -0.2957447401680244, -0.3698927001244875, -1.0581862070520247, 0.6596026617378649, 0.44171540063042375, -0.33759875926283994, 0.21691483650831478, 0.1514357684571448, 0.7932735034855048, -0.8352730464808923, 0.26311501754881333, 0.7400280223275926, -0.20691535345934314, -0.6559788591688628, 0.7663123196738275, -0.6920788908580461, -0.5085382637342994, 0.3236808715697988, 0.07623343580551306, -0.05424578066258478, -0.043093669403148314, 0.031909288269256264, 0.12937691863787393, 0.10803964386224128, 0.13370905885918072, -0.027130157006064012, -0.0452376384990941, -0.3128260122540365, 0.14542426648232182, -0.12259840230406745, -0.08468098016327154, -0.036432719876726756, 0.13189581495905925, 0.16628009377007244, 0.2948489676168674, -0.13332456069169618, 0.1782551670863374, -0.21028515915489154, -0.19781337153844153, 0.3168081512719297, -0.016457980374069214, 0.04927089278424021, 0.03542399277826069, 0.15770084010515203, -0.00402392586952143, -0.016379823706067716, -0.016584652726750197, 0.268287050194472, 0.15375298289742687, -0.04917548624380328, -0.003513860923097094, -0.39954692224675087, 0.25899249304358735, -0.02704864386890536, -0.08556792146422572, -0.1139461675688686, 0.09944853316610176, 0.10258105725090277, -0.1206275954414912, 0.07472383550345006, 0.04074334803323245, 0.05210421270023303, -0.11263324119345519, 0.13112970312947922, 0.19978945413056545, 0.06516273875067873, 0.11718202199588151, -0.05575070759751515, 0.17016856894195595, -0.07370117546283869, 0.04420871251287847, 0.05502733520547644, 0.029538214455630478, -0.12592532531433412, 0.10025980608773499, -0.1449002750946794, -0.03129145228677421, 0.1042430807793072, 0.4146392441123187, -0.06417223818184047, -0.2525584976884579, -0.14783957956541882, 0.013554482048365834, 0.1238988259064228, -0.19389973473261712, 0.052676019129321745, -0.08329812717330033, -0.0553436881405309, 0.04862044888216137, -0.046423168780431845, -0.15084278831382686, 0.08253027107354406, 0.04731826876694121, -0.001899366609952586, 0.13345403151061924, -0.13949316171890566, -0.02743181769095231, -0.3238122457299274, 0.0006756372251130024, -0.10926828482175913, 0.0496363977294963, -0.011576121380752405, -0.2764423770595076, 0.08967118378446666, -0.06944384399107509, 0.05411953520864352, -0.29698992476557295, -0.08758660862984659, 0.18549772706817771, -0.3122671738918255, 0.11790216084756935, -0.11407790804813642, 0.16133717013920584, 0.15375465657590723, 0.07516918868892648, -0.04104303974506815, 0.10430783342794468, 0.5834319119754626, 1.965473282623472, -0.24751274204960058, -0.37432178007762607, 0.3206358123191742, 1.9180851556216314, 1.9248277998278605, 0.2175927860029014, -1.4718526984132183, 0.5370353417322694, -1.6166200966341486, 2.792370062679317, -1.8192683141434496, 0.9395569928154962, 0.8503288243893221, 0.1329961967308806, 1.6135823573824986, 3.8516891386157375, -1.7719947331964059, 0.21061824668443097, -2.5755587980771164, -0.38240146238751027, 1.2742793756118265, 0.6294142127381148, -0.044355721710964156, 0.19075792178571024, 0.3474400050950202, 1.9241009965307343, -0.4281271814906391, 1.4233999121065348, 2.861933554736795, -0.28077216259307214, -0.7885291448695027, -1.3864824980148485, -4.660465988630587, 3.1830110465896713, -0.4908557539469508, -1.7754760003465895, -0.45099483666048945, 3.276427656487668, -0.7454680745033524, 1.1940465013369208, -0.04222706547941528, -0.8701235087399463, 1.091762924959141, -0.5720884504539155, 0.8370848526832433, 0.413838867930334, 0.3810703393255687, 2.01067235803022, -2.249001282577737, -0.9278141398295066, 0.6981772152462512, 1.517624722016134, 0.1364388301801691, 0.3370586051751935, -2.183649530382004, 1.447727447827435, -2.0669067610087133, -0.5624664140246872, 2.3201389123697367, 2.8279209503701406, 1.5389002902942344, -2.077221555949976, -1.8285969107694164, 1.3959149530934676, 0.4875080575117659, -1.6403543232920734, 1.0252530306351677, -0.8688991985115923, -1.466575774959083, 1.2245860504018122, 0.4624874635835982, 2.3234864136972684, 3.9347666854790897, -0.5207654125868271, -2.468858306760336, 1.3762264490168588, -1.057411652885543, -0.22479263377466005, -2.9952275112704787, 0.13664716796668894, 1.0962163972949865, -0.13377453956163698, -0.7218177186146905, -3.896766701204443, 1.8068219885340424, 0.23512061604883971, -0.17183883267199515, -1.8636034739086689, -0.3995299245094741, 2.7575762563309825, -3.783982216587816, 1.3390466993109, 0.4109596139429092, 0.8595436137915304, 0.031947309150110036, 1.880743449919675, -1.4964644632154176, -0.08731477944336384, -3.187993237869061, -0.7342798528235635, 0.5329205962127442, 0.42175074809933544, -0.3118973533256203, -1.2589967460552884, -1.0484325296789032, -1.3171375371251666, 0.25432176442732574, 0.4511566108918645, 3.0715465104554465, -1.4093933205791094, 1.1930182319916809, 0.8439311735263727, 0.3671291970552761, -1.3000151808253881, -1.625823470478009, -2.873949882699386, 1.2992654538286181, -1.7566708845805217, 2.0512429941677035, 1.9480666840117349, -3.113933062334271, 0.16806725182379723, -0.48648434302155863, -0.34774806735582997, -1.5526526730588062, 0.0571254073158081, 0.1577176400753724, 0.1765083710983114, -2.620867555211723, -1.5193949968738112, 0.4779993523913706, 0.02210813662898415, 3.8995234358889674, -2.5262638663515484, 0.26240285945043557, 0.8280902133615242, 1.1200524795247946, -0.9514348659176289, -1.0187666658669023, 1.2008679555317963, -0.7375713811556724, -0.4098350399509123, -0.5041462350005326, 1.1060029971908885, -1.2860798954040313, -1.9672770104456971, -0.6394122978083124, -1.1378492462078018, 0.529639225432849, -1.6872036683136562, 0.733423506949725, -0.42239588829256247, -0.5416370709578759, -0.288356748067227, 1.2225396919048546, -0.9760017248618225, 1.4107946752348604, 0.30361173278021175, -1.0073970063992705, -4.065014982217252, 0.6470304093613389, 2.4728047639746995, 1.441950882798106, -0.12107857398753585, -1.2179098380884403, 1.8980628928083554, -0.5103898038378925, 0.8139087422105953, 0.5327104965511413, -0.468574090618653, 0.46217726580955104, 1.5091860794525995, -0.778564716057322, -0.47153573132610777, -0.0036231677514166113, -1.3041273742350787, 1.3665941146161065, 0.2685929007494065, 3.167444757674974, -0.005427841747738596, 1.087916452860703, -0.490900136910183, 0.10766658861378553, 2.691951153385985, -0.868287085462351, 0.6872286707475849, -0.535473347463498, 2.9130783726036364, 0.8604680652751071, -1.8050536776638295, 3.0464026575158383, -1.1510369548921127, 1.1291592173950258, -1.5838886136455401, -1.5165790889157063, -0.7245479403033415, 0.3913565613663707, -1.0298410517138972, 4.901034967686681, 1.3858116904924909, -0.8403294844904238, -0.690074811331056, 0.5164797920443747, 2.172354071795681, 1.854999135247248, 2.0215987740741266, -0.5910050591120758, -0.6066280654172111, -4.870003222619549, 2.522398047016653, -2.05874929599196, -1.143879842559236, -0.4356402156277787, 1.9838434715463984, 2.684137384210834, 4.884970535151504, -2.212724515291736, 2.685044300869983, -3.4622286256483936, -2.9984771642448615, 4.886033677120012, -0.16572932881665925, 0.7291733844692406, 0.5524469779494459, 2.395839778439144, 0.18367108032073104, -0.298497880453673, -0.06706276362030676, 4.363495802280313, 2.257403260907273, -0.8332326766862737, -0.22799663968007308, -6.5487899385930195, 4.265546821817548, -0.46554940781067944, -1.5009570117539124, -1.756428733034861, 1.8980531060978634, 1.4354095227359207, -1.647731722730435, 1.1090299729118136, 0.4974189125503991, 0.915313167048983, -1.752184793373803, 2.0615887296710853, 3.0319284916487064, 1.0200518255990676, 2.002213960087786, -1.1162548019022025, 2.420267852838429, -1.0107048320211254, 0.8514993086244261, 0.8379178864671781, 0.4831991838276765, -2.1545123260483563, 1.6785530098651602, -2.4227060830344667, -0.5378928745540026, 1.8484447527593713, 6.5417802672937375, -0.7621222695939346, -4.0295502259100555, -2.4363596143743047, 0.3789298782297552, 1.909479846952163, -3.0994275558821296, 0.9154174211445824, -1.352291964130441, -1.0110931984880243, 0.8801804127734809, -0.6337494594750852, -1.9552996858015108, 1.729122697045509, 0.6397176313707685, -0.3409985459825324, 2.1645326046749473, -2.214219036711719, -0.4375677730906774, -5.208440134120013, 0.027381883275330587, -1.490716940092044, 0.7232996661482396, -0.26405383271614846, -4.616176719797995, 1.5661200000114064, -1.0058586211189633, 0.7853372582461627, -4.665114757868831, -1.3568032442362945, 3.11561848439395, -5.13615835990999, 1.9278944251880188, -1.6492297324256395, 2.514925636824346, 2.297033109082742, 1.359209515983199, -0.8016088500101354, 1.5445143696566226, -1.3196226200833785, -0.922068901176294, 0.271224690015008, 0.27488259458733466, -0.2180741573173122, -1.0908545241964016, -1.0189790774525456, -0.5372917109219105, 0.5864163536378991, -0.0224099754572572, 1.6273898528149637, -1.4389511851588939, 1.0342620248384964, -0.01997160647916086, -0.15775967871858512, -0.5027045775028074, -1.1172435464418609, -2.3123001376930223, 1.0557194753175208, -0.6897218581050867, 1.5917934909594744, 0.8151122333994174, -1.5267521419290782, -0.15328620889543373, -0.15634543274553822, -0.18685616894482818, -0.6640626097604624, -0.6294042493571455, 0.20006476452356978, -0.41834042348986084, -1.8890624250093118, -0.4402842826937161, 0.43451544144358645, 0.4758222689912613, 2.9464824709122306, -1.9641336719617015, 0.25810571903552665, 0.8909671993958299, 0.5466767561116437, -1.4410820777787166, -0.10711671377595075, 0.019817660492076613, -0.24548595371247842, 0.1494026539488531, -0.5460862687330543, 0.5826068712455651, -0.7354773207575674, -0.8324896427393594, -0.3538116573440927, -1.079446422622266, 0.9457142863703564, -0.2809563850779296, 0.022595286820097437, -0.6610560819242711, -0.23679888539806201, -0.21532804280518242, 1.167662853132264, -0.8324166930585133, 1.1945490683345037, 0.2967914000225752, -1.1379738475442172, -2.3861467350919416, -0.29163261753143205, 1.572024867097028, 1.1250743576441267, -0.5138594841928497, -0.5934636834870031, 1.222151893139125, -0.5258331488399883, 0.5799387627449081, 0.6826714338478108, -0.5783965841060001, 0.0066362469933106735, -0.2528726251816241, -1.6024411033732453, 0.009741072853141674, 0.8321398648314742, -0.9238316056311308, 0.8382069426572456, 0.1704703008148576, 2.126539390939189, -0.04803961658298252, 0.013065686378471207, -0.1277152540842842, 0.2815804642207076, 2.263424984072617, -0.9157042985888202, 0.1626421051873015, -0.13056258846080124, 1.6549587661432859, 0.4378893227750911, -1.566540183943228, 2.350174597806313, -0.8573689925318959, 0.25891264158372707, -0.8479340484584127, -0.5448577708510729, -0.8900393818538349, 0.6429822825758325, -0.33319031587287135, -4.671216846916186, -0.3805930626020432, 0.7239110209980238, 0.5051408908832377, -0.356929728968732, -1.2038948445177218, -0.8781718414062729, -1.938846428934928, -0.16858053631488482, 0.8963369179437719, 4.100172821435521, -1.1027272039939107, 1.1401578340138947, 1.651993933029702, 0.8863416634362062, -1.9446914336304817, -1.8825082587404192, -2.948199544681055, 1.321171344919061, -2.616067012590456, 2.1701323620597455, 2.844580547412135, -4.295220907108051, 0.49694518270943777, -0.76347303593925, -0.46126941898991225, -2.2509961166565873, 0.8183031132437395, 0.07948577836839835, 0.8113967318976429, -2.9356177610736642, -2.4385021662617414, 0.43418315178593714, -0.49255230237866693, 4.215081599897815, -2.668503807381262, 0.21633139518290675, 0.5967149677347652, 1.547742170833655, -0.21606818045601806, -1.8466215551693483, 2.296437476160676, -1.1480196308336528, -0.9594008426271051, -0.35916640085478474, 1.480197453630518, -1.6559439281217574, -2.862125941807241, -0.83663354675399, -0.9828064521838388, -0.04114117657483008, -2.941744204398396, 1.3907346585582927, -0.07198979944082211, -0.7794661888305453, -0.31456472010386827, 1.0471009656959818, -0.9481760758415256, 1.3803548026306118, 0.2523841708354114, -0.6650830363905075, -5.164933115811929, 1.5773871161680204, 3.006354054415909, 1.5186639903859795, 0.34423953418511155, -1.6840633896545019, 2.2901607050453583, -0.39400419414755683, 0.9192002866787582, 0.2606793191345901, -0.2541358639320252, 0.8849431009985919, 3.198504645367358, 0.29923172090051203, -0.9214355913113637, -0.9430489614892928, -1.4789164468924694, 1.695849135048802, 0.3268624746948053, 3.723859986939706, 0.04355804663571755, 2.08593699691876, -0.8042047595853876, -0.10885165687934793, 2.651760572887205, -0.6465040986932296, 1.1440029321432255, -0.8870673096671551, 3.763178562297645, 1.1688884911999409, -1.7231775620612564, 3.2385808418164364, -1.2580795910122122, 1.8890247399738507, -2.104476590032891, -2.3154329215266647, -0.3978311193788818, 0.032387396329372396, -1.6137003751509997, -4.2471533794219285, -1.3219636896017244, 0.7381297376382214, 0.6176490997238887, -0.4649947181275592, -1.9940875104809541, -1.7220661833557638, -1.750332544103967, 0.6063738047286115, 0.48473532876429154, 4.2899685729619925, -2.353404079318887, 1.8899055291767197, 0.9189485500488583, 0.3168667039534985, -1.7122293960963622, -2.413023556892561, -4.4530768197468085, 2.018927506167991, -2.3194847572434036, 3.1457482314636445, 2.6001404784504234, -4.280717366073764, 0.09997809002937358, -0.6230718051640759, -0.4871440891100158, -2.080377678980205, -0.2870484002190268, 0.28506615024869225, -0.038112552699919325, -3.9388104432767452, -1.9192858521780083, 0.768407620900199, 0.2889628121274301, 5.935970830754244, -3.8762985691399625, 0.43271032994011405, 1.4080521647194264, 1.5383538223221753, -1.8498958448712746, -1.182298186868151, 1.3344370843807716, -0.9493521969843278, -0.3685779177667697, -0.8592658743251808, 1.5428508546058672, -1.8263138883383818, -2.630974571993302, -0.9014144678507152, -1.8542329908737996, 1.1095883392340968, -2.0156192696254784, 0.8208344488061892, -0.8331060986749997, -0.7285919907883812, -0.43752471160048256, 1.9966221139647768, -1.5384989018569868, 2.2190396240227863, 0.49963717696098736, -1.74301441191863, -5.806755449609536, 0.55088689532186, 3.599337381428828, 2.2147413507444114, -0.41918519766449264, -1.6722151396004763, 2.771383218976881, -0.8548841055658735, 1.2194646290341289, 0.9666983465182005, -0.8380309298215591, 0.5130328676143325, 1.522579628465152, -1.749113907921137, -0.514239152970796, 0.4587491751630166, -1.9509444682215287, 1.9721711960768848, 0.39079915694412687, 4.673223778573287, -0.03269595599943347, 1.206204176452848, -0.612017363956867, 0.2752371938623049, 4.225326254670026, -1.4661071118297015, 0.8478036241682152, -0.6627226439104157, 4.130659445500303, 1.1917835048202419, -2.860392218157143, 4.664189922299401, -1.7452721552274642, 1.3883680465571206, -2.2170497533864646, -1.9743345284260791, -1.2934274371935035, 0.7888485996784302, -1.3202192870343152, 3.5130394868115897, -0.7002666731835715, -0.4636220761322348, -0.21981478614656672, 0.12644305385554908, -0.003828619599439985, -0.27318543512499194, 1.470767103582284, 0.8946638663937532, -1.0079081107546675, -2.5154715654264628, -0.5361026684501388, 0.0050306588856105575, -1.831791324629926, -1.1608922229213532, 1.5190508623249432, 0.7067474216443849, 0.4254988921680808, -0.1670465260093596, 2.0271717841534183, -0.44674095064648095, -2.1253509892852547, 2.8507737243526363, -0.7293986697834991, 0.6460399335014883, 0.2784188846566689, 1.658788648012663, -1.6576494852847155, 0.15532377149721066, -1.394474955236194, 0.9243115509482662, 2.1349728977221782, 0.0511568137451456, 1.115212674345934, -1.0436623761734258, 0.5411185895125479, 0.0758808555724795, 0.4261201094589598, -1.031456541523586, -1.5088614489280578, 1.89083635905603, -2.488749933728842, 0.9588516583598374, 1.230712106864357, -0.26836226278175196, -0.9140347779271307, 0.9211956336601417, 2.1235034438122438, 0.4869421539704702, -0.2319262294182496, 1.190362990676117, 2.8785785943942606, -1.494370270934321, -0.7218284911637312, 0.566103074346923, 0.08341325909706468, 0.2684136464733323, 0.029356977893256638, -0.06366944636029152, 0.08328397891780079, -0.650459741049384, 2.761603208189282, -2.0791632364625867, -1.3856723498828034, -0.299146929883541, -0.998996097897127, 1.123955320007009, -1.025745179565551, -0.2057145346450504, -0.30342567701755696, 0.5415434871569892, -0.4224169228874351, -0.9602634181602395, -3.8060404085409014, -2.2681206838075942, 1.0200277594827203, 2.0396771733511363, 0.49937873905521313, -0.8404447512758573, -0.15119623249831013, -1.499196105609152, -0.10584137705772621, -2.266598571634389, 0.7252821565923057, 0.4601246639698292, -0.16032906507811973, -0.40159996982375185, -1.0547880846456643, 0.8125015812801659, -2.113345578439338, -0.748668185502566, -0.01173079485500321, -0.6973632866819585, 0.3382324088789769, -1.753394967278986, 1.2757825486219443, 1.873663056935765, -0.6426141958261271, 0.7432722274224288, 1.3621793022328115};
  tensor_t cols = tensor_make(shape_cols, dim_of_shape(shape_cols));
  tensor_fill_list(cols, cols_values, array_size(cols_values));

  uint shape_x_padded[] = {4, 3, 7, 7};
  T x_padded_values[] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
  tensor_t x_padded = tensor_make(shape_x_padded, dim_of_shape(shape_x_padded));
  tensor_fill_list(x_padded, x_padded_values, array_size(x_padded_values));


  uint shape_ref[] = {4, 3, 7, 7};
  T ref_values[] = {-0.5801606529496699, -0.5460854908303573, -1.340792310983478, -0.013737654753126716, -0.6359733687060483, -1.4618918436243773, 0.6980798479603341, -3.3028366520095136, 2.3893784413537604, -1.086499031464843, 3.1783440153385563, -1.062687782827449, -1.1195497558883487, -0.2609314782481984, -0.33232746904865174, 1.6458385430861795, -0.7505105292942033, 3.1043544222013613, -0.8864534098016739, 0.6784390752550697, -0.6377602040812999, 1.026855366204698, 0.35557405775526496, -0.8118633673263841, -0.12165263259691705, -0.007017699808502226, 2.4287523550752814, -2.49920515565195, -3.0540366920908726, 0.5540525741077176, -2.039740782440732, -0.5547372329046577, 0.29605125555704526, 2.0940311554270457, -2.0055827335047605, 3.593351650922118, 1.7337405027573172, 1.651396303603286, 4.1962351124621335, 0.5106618453307328, 2.2418122243344385, -1.5446373839199967, 1.8994225539165615, -0.005470576328842222, -1.7030182619505352, 1.3465064797339468, -1.1121778921447607, -1.5116468236287608, -0.1497337810138964, -1.7775808303695202, -0.22705186378889258, -2.125416483934393, -1.3424895541116066, -0.5020565804118924, -1.3783560873567786, 1.005711885640877, 5.061764124136659, -1.0970967276343884, 2.5933857174116843, 1.433177334519089, 2.3174087346089283, -3.8882791270110113, 1.3679543066996391, -1.4027401787559404, 5.502916207869786, -1.6913035693921714, 5.1284108112660896, -1.5749812712784488, 1.181274078486077, -2.216458028275241, 7.985888692144746, -0.7091331902285642, 4.2969408357892585, -2.537818959733747, -1.1624681895119187, 2.2674472500218736, -3.558480139766585, -1.4751170031126195, -4.665832352317038, -0.03426934930491235, -9.174951461107348, 4.461805617921245, -0.21120500200599227, -0.25529326597523605, -4.839492249471013, 6.023903204520266, -2.1150562878543715, -1.4789305893310685, 11.556732885789927, -3.035863857201064, 1.596433571399142, 1.9194080036038101, 0.5784869599896236, 1.0985110560538498, 3.062960122093051, 0.5527210579230303, 0.8037103250416198, -0.2594502720218918, -1.0801186261836029, 0.3705488637720846, -0.12343642766488949, -0.22888278455733196, -1.3835918697442349, -1.6529882203733772, 1.6135823573824986, -3.766430285411134, 4.1368255868210495, -3.2527595306763213, 0.07939775283543757, -3.742859093068219, 2.902821620310922, -1.6080993003888118, -3.504514498223071, -8.042531270150493, 4.6009753391114, 3.783325042023391, 0.11850849817637488, -1.866774974442126, -1.2187963897020926, 2.0462006632335785, 3.000701908563188, 1.7171688012173048, 1.2699814373246636, 0.5463729381938481, -1.1874617985693536, -1.2253145980555924, -3.1789431693678933, 1.0552261019801268, -7.234188719693627, 1.2206557426371463, 0.0515869266734677, -3.462338015970675, 1.1325008204549165, 2.5023617212844664, -5.325123967038879, 2.4972896263070137, 3.844232445531885, -7.419030665806508, 4.145693463891832, 1.4948194025000634, 3.723859986939706, 4.564372121693939, -2.1110262214140025, 3.03598286187585, 3.161258582052902, -2.6716978151080375, 1.873663056935765, 0.48961753760732074, 0.05195897023650964, 1.2822191010504982, 1.6619927222084931, 1.3091101747074103, 0.33399652323995765, 2.0825383947006397, -1.030628277672404, -3.4609800180399146, -0.13301868619041196, -1.2627479736953091, -4.943114393798272, -3.1808907302666998, -0.9648146577187111, 2.395374025332685, -2.5122251007365715, 3.3025012977035395, 0.10782511360528613, 3.2562580244697568, 2.5541181095147665, 2.581701132808508, 2.085628468196444, -2.7270757084409274, -0.7624980504625916, -0.7519501800665094, -1.7063490206705945, 0.8540530082022754, -0.21298422047119303, -3.148188749781835, -0.9973530184913901, 0.45906549603700575, -0.878009614648292, -6.319661188767736, 0.8217309300054724, 2.067449013715139, -2.7642693533673564, 4.005367774768885, 7.225596578028764, 0.7245829492866801, -4.104205280163951, -0.4057896435721713, 0.8017942829116939, 0.0316407302825918, 1.2211845820978788, 2.495032533911138, -2.7074324260328746, -0.9635494964819421, 0.3061817255580419, 0.998739178703421, 1.9743577722731647, 1.6071705281997963, 2.681190173112425, 3.413582585256018, 3.580458852800608, 1.1251529418925128, 2.6972682694204395, -0.5249669479009498, -2.3602635547609787, -1.3524093435522664, -4.443076817858737, -1.5469427484841316, -6.9126129184322, 1.7124568082996219, -3.5519913394961486, -0.20166856078902512, -2.9113124329129487, 0.5973683049682246, 1.9458224698849853, 3.5885669116405285, -0.3629989244815652, -5.094332981966609, -1.965246202009099, -1.522467279118447, 1.6999492239824516, 1.8739604161660859, 1.327966212004685, 2.0836749748197, 3.195560951079571, -8.839632252554656, 0.4179391339822527, -9.62064103796975, -3.216006661481166, -2.2989091365283105, 2.7466686698545124, -1.4716091048484623, -1.242167056662563, 0.6033737658978247, -3.6655167867363794, -7.572785081456931, -0.6876335914323056, 0.5766782610739472, -0.16026064725030148, 3.228727384139633, 0.6686133766904154, -0.8434314320278562, -1.3117253155495148, -0.28985248160595434, -0.12748997080720012, 0.8110243692054991, 0.6264726422239308, 2.606320001548682, 2.791968675800416, 1.4035100352188012, 1.2344059604323636, 3.8516891386157375, -0.08924185367955384, -0.1152453797830002, 2.256801744095311, -1.4720175581187132, -3.279690593167414, 3.3929485091932685, -4.087776138039612, 2.7926295850670604, -5.831952478371235, 1.4851686424430732, 2.1367053486925083, -0.3966638155839217, -5.692118359035517, 2.7641935393913455, 3.8743619246401595, 2.7658651279546884, -1.9707725338039297, 5.238770192723404, -2.5159380223281422, 5.997702212214137, 0.9699298654173052, -1.6919024671691676, 8.17782566149058, -3.0448940185429088, -7.1278645455336465, -5.672085694613728, 1.0655484744724317, 0.9862688221818008, -5.170360957559668, -2.743182878763109, 1.5104803334262065, -0.13375355218396645, 2.598542755583089, -5.2551443533111275, -0.3906606427986218, 0.04355804663571755, 2.619064616887772, 7.882663439909945, 2.712250789409971, -4.2564488530456845, -0.9551950283145266, -0.6426141958261271, 0.04593308136767601, 0.5089422611523551, -0.13168008593648967, 2.2301166152429426, -0.4023568030214058, 1.243770036756641, -0.9675560859336442, 0.2199168892797514, -2.699886281898523, 1.4563770816749104, -2.3463686334587686, 2.838868141234764, -0.8220596689555263, -0.014196139647875541, -2.9362777881350874, -0.7133579319751514, -1.8241147960483552, 5.289535532770468, 1.4166725121250856, 0.32609813921881614, -2.000042780753771, -2.237995655082156, -1.6666582792553553, 1.4800587955849804, 5.268276112642665, 3.1508439734602383, 2.4045000547358093, -0.5865768679874751, -0.04106133355142971, -4.202541285853794, 2.7414430217927404, 1.4400631363130894, -3.980329106049828, 1.7668699739499285, -2.1432984883820776, 1.4609516506695266, -5.472584763726749, 0.6195376206686672, 1.4318638444414484, -1.5128901645812667, 3.9803885157183942, -0.5959907584835028, 1.2162274245520692, -0.7828126233000461, 1.0914967019201098, 1.9271602541236081, -0.5513720384335499, 0.6673685824015115, -0.8151916082636291, 0.1018954454166123, 1.7210126010899172, 0.33125509640867573, 3.125966366558989, -1.7079968668891274, 0.8815874513726131, -1.2476449919516048, -1.69586531852469, -1.5103829195418121, -5.908576265560946, -2.29040885299462, -2.160197119389326, -1.2322611279252438, -1.4881242564152908, 4.791846746240576, -0.35146031985305604, 1.8113767231704214, -5.211575558602496, 4.817808987220736, -3.6264636204135496, -2.4461045592301778, 4.498000200459166, 2.4590557554153083, -0.061662478837497814, 13.040970556681936, -2.5198272348898243, 7.080860835983597, -1.9046442753637085, -1.4893525262828675, 2.1190443795578506, 3.9113740358359155, 1.1892833606533895, -6.42433010821176, 2.7239526867998607, -2.4741629777282754, -6.710424670690524, -2.4515668331358578, -2.963952139708503, -6.4110292997517675, 0.5982309769987044, 0.3414616855302469, -0.20834637952613766, -1.8770554633577567, -2.0335591357482707, 0.1559258509156515, -1.343551578548303, 1.472636474124063, 0.29840963112455704, 0.06977358684209452, 0.09375018793173735, 0.5935403367947202, 0.2908670126875471, 2.267430744711282, -2.100828733161887, 0.7170042636976259, -1.7719947331964059, -0.11441088126963772, -2.061374155445279, 7.120606675848738, -5.869283352702826, 5.190495688239648, -7.144896350209776, 0.6047246386570313, -2.7424830147922665, 3.180593350925804, -0.8145280719550123, 13.12150128399597, -10.958072659855242, 2.0396275762094973, -1.6872765309064293, -3.8543496453782056, -7.032416580017973, 1.2314040013627499, 1.9049767451282817, 10.214161172665646, 1.6304600014764048, -0.8943191260746253, 0.6173113963692078, -4.034993855872354, 2.579277668955096, 1.3274595882631322, 4.4148273246121175, -0.6616008675174138, -0.7219269669184635, 2.6653035690287235, -3.4921805198870364, -1.0510453052634883, 1.2465370619956326, -0.3317051339995235, -0.8386456961571178, -0.19746246870002482, 2.08593699691876, 0.5597000777596184, -2.5638171922641497, 2.6792082749703408, 0.672087257383927, -0.9645463676005557, 0.7432722274224288, -0.024384376355059856, -0.14511620740788278, 0.22546078142164627, -1.109360417397809, 1.2040442315653768, -0.7337677349094827, -0.5472286212535535, 0.7564772355861019, -0.45783830975786555, -1.292816466307824, -1.8163433512262335, -0.9450292589507934, 2.563533702089685, 2.2609529610313874, -0.23567258247349315, -3.1146625700849953, -6.206585440508629, -3.373235865459624, -5.558038659287572, -2.915036111355096, -0.1259205835343769, 0.19306159671178913, 0.6368582532821552, -1.3237308786738025, 1.5818073964124106, 0.28729611773317276, 0.8153769438689271, 1.6551469927412799, 2.148605059528097, 1.5991749155476371, -2.133780353895718, -1.135403155854373, 1.9443450115172825, 0.09851122206164356, -0.7917944944860483, 1.1871453030743013, 2.3479920900110693, -4.626671055472789, -5.105287229005209, 0.7610226078745426, 0.7518526706643722, -0.19870595343260816, -0.45304548519273946, 0.788786310417277, -1.1459185673169654, -1.2369143840144063, 0.6027201502333155, 0.5646211655952578, -0.16421868133760634, -0.15166177594875785, -0.7455312785917946, 2.1270723469797583, -0.9429200496947061, 0.8569452168086298, -0.49120146823522637, -0.32363255182911, 0.5653734198345601, 5.952172034127022, -2.855999458131776, 4.633700646671176, 8.026068913093932, 3.4266744082058485, 4.5825895066833136, -2.7220790395852776, -4.956336096038721, -4.249346924996621, 0.8190620315078606, -6.802250388821446, -0.9063423102269245, 0.34264318174671815, 0.9170730105370359, 2.1623177360429318, 6.565601541984196, -0.902394477977944, -1.2428769878204813, -0.2672224378737862, -0.6278322104213133, -1.7871134039196275, 2.249346118375289, 2.6897123679655537, -1.2982675267862347, 2.0111392135442974, 0.8903542305104417, -0.6175713350481029, 2.6145610323950024, -1.1947330726908514, -0.9896303386693156, -0.5377990118226883, 3.7092295235693373, 1.6210964344993832, 1.1252440509712163, 0.4162590821744573, -0.5335137076982512, -2.5861232934738254, -0.07677545874859043, 0.5179208286431898, -0.07248240742952361, -0.17597438354605396, -0.029085296392588226, -0.5029264092955992, 0.7487611610514785, -0.13816386018570234, 2.2649223902157596, 0.31125136381721796, 0.21061824668443097, 0.8607892564313694, -0.8846292313534232, 0.6742506482844205, 3.481708412186668, 0.2396478193508409, 5.464799303122948, 2.5867057983825816, -0.012670230807809157, -2.024443910197018, -6.519572549371406, -3.074743380990682, -3.079367472695695, -0.5607473078938792, 0.02362329235001459, -0.01541661769512026, -0.9094165142999651, -3.7315635936733482, -7.048867831978165, -0.19028947741529256, -2.610195402995691, -1.4368626826801427, 1.2176591811795703, -4.870839394315791, -5.747928328998303, 1.6378190183270696, 5.433727164379253, 1.1190751830399914, 0.16643950028929455, 2.515453917505726, 7.30002642337001, -1.8070525477050248, -1.0908397247627626, -0.691249199996205, 2.1074072376250568, -0.48438654837118145, -0.8042047595853876, 0.5319855681863584, -0.15009178130073553, -6.019656892835698, -3.8424809233924675, -0.044436738412370946, 1.3621793022328115};
  tensor_t ref = tensor_make(shape_ref, dim_of_shape(shape_ref));
  tensor_fill_list(ref, ref_values, array_size(ref_values));

  col2im_inner(cols, x_padded, 4, 3, 5, 5, 5, 5, 3, 3, 1, 1);

  tensor_print_flat(x_padded);
//  tensor_dump(x_padded);
  EXPECT_LT(tensor_rel_error(ref, x_padded), 1e-7);
}

TEST_F(LayerConvTest, im2col_numerical1) {
  conv_param_t conv_params = {2, 1};

  uint num_img = 2;
  uint img_sz = 4;
  uint nr_in_channel = 3;
  uint fil_sz = 4;
  uint nr_filter =3;
  uint sz_out = 1 + (img_sz + 2 * conv_params.padding - fil_sz) / conv_params.stride;

  uint const shape_x[] = {num_img, nr_in_channel, img_sz, img_sz}; // 2x3x4x4
  uint const shape_w[] = {nr_filter, nr_in_channel, fil_sz, fil_sz}; // 3x3x4x4

  EXPECT_EQ(2, sz_out);

  tensor_t x = tensor_make_linspace(-0.1, 0.5, shape_x, dim_of_shape(shape_x));
  tensor_t w = tensor_make_linspace(-0.2, 0.3, shape_w, dim_of_shape(shape_w));

  lcache_t cache;
  make_empty_lcache(&cache);

  tensor_t ret = im2col(x, w, conv_params);// forward function should allocate and populate cache;
  uint const shape_ref[] = {384};
  tensor_reshape_(&ret, shape_ref, dim_of_shape(shape_ref));

  tensor_t ref = tensor_make(shape_ref, dim_of_shape(shape_ref));
  T value_list[] =
    { 0.               ,  0.               ,  0.               ,
      0.               ,  0.               ,  0.               ,
      -0.068421052631579,  0.234736842105263,  0.               ,
      0.               ,  0.               ,  0.               ,
      -0.074736842105263,  0.228421052631579, -0.062105263157895,
      0.241052631578947,  0.               ,  0.               ,
      0.               ,  0.               , -0.068421052631579,
      0.234736842105263, -0.055789473684211,  0.247368421052632,
      0.               ,  0.               ,  0.               ,
      0.               , -0.062105263157895,  0.241052631578947,
      0.               ,  0.               ,  0.               ,
      0.               , -0.093684210526316,  0.209473684210526,
      0.               ,  0.               , -0.043157894736842,
      0.26             , -0.1              ,  0.203157894736842,
      -0.087368421052632,  0.215789473684211, -0.049473684210526,
      0.253684210526316, -0.036842105263158,  0.266315789473684,
      -0.093684210526316,  0.209473684210526, -0.081052631578947,
      0.222105263157895, -0.043157894736842,  0.26             ,
      -0.030526315789474,  0.272631578947368, -0.087368421052632,
      0.215789473684211,  0.               ,  0.               ,
      -0.036842105263158,  0.266315789473684,  0.               ,
      0.               ,  0.               ,  0.               ,
      -0.068421052631579,  0.234736842105263,  0.               ,
      0.               , -0.017894736842105,  0.285263157894737,
      -0.074736842105263,  0.228421052631579, -0.062105263157895,
      0.241052631578947, -0.024210526315789,  0.278947368421053,
      -0.011578947368421,  0.291578947368421, -0.068421052631579,
      0.234736842105263, -0.055789473684211,  0.247368421052632,
      -0.017894736842105,  0.285263157894737, -0.005263157894737,
      0.297894736842105, -0.062105263157895,  0.241052631578947,
      0.               ,  0.               , -0.011578947368421,
      0.291578947368421,  0.               ,  0.               ,
      0.               ,  0.               , -0.043157894736842,
      0.26             ,  0.               ,  0.               ,
      0.               ,  0.               , -0.049473684210526,
      0.253684210526316, -0.036842105263158,  0.266315789473684,
      0.               ,  0.               ,  0.               ,
      0.               , -0.043157894736842,  0.26             ,
      -0.030526315789474,  0.272631578947368,  0.               ,
      0.               ,  0.               ,  0.               ,
      -0.036842105263158,  0.266315789473684,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.               ,  0.032631578947368,
      0.335789473684211,  0.               ,  0.               ,
      0.               ,  0.               ,  0.026315789473684,
      0.329473684210526,  0.038947368421053,  0.342105263157895,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.032631578947368,  0.335789473684211,
      0.045263157894737,  0.348421052631579,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.038947368421053,  0.342105263157895,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.007368421052632,  0.310526315789474,  0.               ,
      0.               ,  0.057894736842105,  0.361052631578947,
      0.001052631578947,  0.304210526315789,  0.013684210526316,
      0.316842105263158,  0.051578947368421,  0.354736842105263,
      0.064210526315789,  0.367368421052632,  0.007368421052632,
      0.310526315789474,  0.02             ,  0.323157894736842,
      0.057894736842105,  0.361052631578947,  0.070526315789474,
      0.373684210526316,  0.013684210526316,  0.316842105263158,
      0.               ,  0.               ,  0.064210526315789,
      0.367368421052632,  0.               ,  0.               ,
      0.               ,  0.               ,  0.032631578947368,
      0.335789473684211,  0.               ,  0.               ,
      0.083157894736842,  0.386315789473684,  0.026315789473684,
      0.329473684210526,  0.038947368421053,  0.342105263157895,
      0.076842105263158,  0.38             ,  0.089473684210526,
      0.392631578947368,  0.032631578947368,  0.335789473684211,
      0.045263157894737,  0.348421052631579,  0.083157894736842,
      0.386315789473684,  0.095789473684211,  0.398947368421053,
      0.038947368421053,  0.342105263157895,  0.               ,
      0.               ,  0.089473684210526,  0.392631578947368,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.057894736842105,  0.361052631578947,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.051578947368421,  0.354736842105263,
      0.064210526315789,  0.367368421052632,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.057894736842105,  0.361052631578947,  0.070526315789474,
      0.373684210526316,  0.               ,  0.               ,
      0.               ,  0.               ,  0.064210526315789,
      0.367368421052632,  0.               ,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.133684210526316,  0.436842105263158,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.127368421052632,  0.430526315789474,
      0.14             ,  0.443157894736842,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.133684210526316,  0.436842105263158,  0.146315789473684,
      0.449473684210526,  0.               ,  0.               ,
      0.               ,  0.               ,  0.14             ,
      0.443157894736842,  0.               ,  0.               ,
      0.               ,  0.               ,  0.108421052631579,
      0.411578947368421,  0.               ,  0.               ,
      0.158947368421053,  0.462105263157895,  0.102105263157895,
      0.405263157894737,  0.114736842105263,  0.417894736842105,
      0.152631578947368,  0.455789473684211,  0.165263157894737,
      0.468421052631579,  0.108421052631579,  0.411578947368421,
      0.121052631578947,  0.424210526315789,  0.158947368421053,
      0.462105263157895,  0.171578947368421,  0.474736842105263,
      0.114736842105263,  0.417894736842105,  0.               ,
      0.               ,  0.165263157894737,  0.468421052631579,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.133684210526316,  0.436842105263158,
      0.               ,  0.               ,  0.184210526315789,
      0.487368421052632,  0.127368421052632,  0.430526315789474,
      0.14             ,  0.443157894736842,  0.177894736842105,
      0.481052631578947,  0.190526315789474,  0.493684210526316,
      0.133684210526316,  0.436842105263158,  0.146315789473684,
      0.449473684210526,  0.184210526315789,  0.487368421052632,
      0.196842105263158,  0.5              ,  0.14             ,
      0.443157894736842,  0.               ,  0.               ,
      0.190526315789474,  0.493684210526316,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.158947368421053,  0.462105263157895,  0.               ,
      0.               ,  0.               ,  0.               ,
      0.152631578947368,  0.455789473684211,  0.165263157894737,
      0.468421052631579,  0.               ,  0.               ,
      0.               ,  0.               ,  0.158947368421053,
      0.462105263157895,  0.171578947368421,  0.474736842105263,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.165263157894737,  0.468421052631579,
      0.               ,  0.               ,  0.               ,
      0.               ,  0.               ,  0.               };

  tensor_fill_list(ref, value_list, array_size(value_list));

  EXPECT_LT(tensor_rel_error(ref, ret), 1e-7);
  PINF("Consistent with expected results");
}

TEST_F(LayerConvTest, im2col_numerical2) {
  conv_param_t conv_params = {1, 0};

  uint n = 1;
  uint img_sz = 3;
  uint c = 2;
  uint fltr_sz = 2;
  uint num_fil = 2;
  uint sz_out = 1 + (img_sz + 2 * conv_params.padding - fltr_sz) / conv_params.stride;

  uint const shape_x[] = {n, c, img_sz, img_sz}; // 2x3x4x4
  uint const shape_w[] = {num_fil, c, fltr_sz, fltr_sz}; // 3x3x4x4

  EXPECT_EQ(2, sz_out);

  T x_values[] = { 1, 0, 1, 0, 1, 0, 1, 1, 1, 2, 3, 2, 1, 0, 1, 2, 1, 2 };
  tensor_t x = tensor_make(shape_x, dim_of_shape(shape_x));
  tensor_fill_list(x, x_values, array_size(x_values));

  T w_values[] = {1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 2, 2};
  tensor_t w = tensor_make(shape_w, dim_of_shape(shape_w));
  tensor_fill_list(w, w_values, array_size(w_values));

  lcache_t cache;
  make_empty_lcache(&cache);

  tensor_t ret = im2col(x, w, conv_params);// forward function should allocate and populate cache;

  uint const shape_ref[] = {32};
  tensor_reshape_(&ret, shape_ref, dim_of_shape(shape_ref));

  tensor_t ref = tensor_make(shape_ref, dim_of_shape(shape_ref));
  T value_list[] = {1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 2, 3, 1, 0, 3, 2, 0, 1, 1, 0, 2, 1, 0, 1, 1, 2};

  tensor_fill_list(ref, value_list, array_size(value_list));

  EXPECT_LT(tensor_rel_error(ref, ret), 1e-7);
}

TEST_F(LayerConvTest, im2col_dot_operation) {
  conv_param_t conv_params = {1, 0};

  uint n = 1;
  uint img_sz = 3;
  uint c = 2;
  uint fltr_sz = 2;
  uint num_fil = 2;
  uint sz_out = 1 + (img_sz + 2 * conv_params.padding - fltr_sz) / conv_params.stride;

  uint const shape_x[] = {n, c, img_sz, img_sz}; // 2x3x4x4
  uint const shape_w[] = {num_fil, c, fltr_sz, fltr_sz}; // 3x3x4x4

  EXPECT_EQ(2, sz_out);

  T x_values[] = { 1, 0, 1, 0, 1, 0, 1, 1, 1, 2, 3, 2, 1, 0, 1, 2, 1, 2 };
  tensor_t x = tensor_make(shape_x, dim_of_shape(shape_x));
  tensor_fill_list(x, x_values, array_size(x_values));

  tensor_t w = tensor_make(shape_w, dim_of_shape(shape_w));

  lcache_t cache;
  make_empty_lcache(&cache);

  tensor_t ret = im2col(x, w, conv_params);// forward function should allocate and populate cache;

  uint const shape_ret[] = {ret.dim.dims[0], ret.dim.dims[1]};
  uint const shape_ref[] = {32};
  tensor_reshape_(&ret, shape_ref, dim_of_shape(shape_ref));

  tensor_t ref = tensor_make(shape_ref, dim_of_shape(shape_ref));
  T value_list[] = {1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 2, 3, 1, 0, 3, 2, 0, 1, 1, 0, 2, 1, 0, 1, 1, 2};
  tensor_fill_list(ref, value_list, array_size(value_list));

  EXPECT_LT(tensor_rel_error(ref, ret), 1e-7);

  tensor_reshape_(&ret, shape_ret, dim_of_shape(shape_ret));
}

TEST_F(LayerConvTest, forward_from_picture) {
  conv_param_t conv_params = {1, 0};

  uint n = 1;
  uint img_sz = 3;
  uint c = 2;
  uint fltr_sz = 2;
  uint num_fil = 2;
  uint sz_out = 1 + (img_sz + 2 * conv_params.padding - fltr_sz) / conv_params.stride;

  uint const shape_x[] = {n, c, img_sz, img_sz}; // 2x3x4x4
  uint const shape_w[] = {num_fil, c, fltr_sz, fltr_sz}; // 3x3x4x4
  uint const shape_y[] = {n, num_fil, sz_out, sz_out}; // 2x3x2x2

  EXPECT_EQ(2, sz_out);

  T x_values[] = { 1, 0, 1, 0, 1, 0, 1, 1, 1, 2, 3, 2, 1, 0, 1, 2, 1, 2 };
  tensor_t x = tensor_make(shape_x, dim_of_shape(shape_x));
  tensor_fill_list(x, x_values, array_size(x_values));


  T w_values[] = {1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 2, 2};
  tensor_t w = tensor_make(shape_w, dim_of_shape(shape_w));
  tensor_fill_list(w, w_values, array_size(w_values));

  tensor_t y = tensor_make(shape_y, dim_of_shape(shape_y));
  lcache_t cache;
  make_empty_lcache(&cache);

  status_t ret = convolution_forward(x, w, &cache, conv_params, y);// forward function should allocate and populate cache;
  EXPECT_EQ(ret, S_OK);

  tensor_t y_ref = tensor_make_alike(y);
  T value_list[] = { 6, 2, 3, 4, 3, 3, 7, 7 };
  tensor_fill_list(y_ref, value_list, array_size(value_list));

  EXPECT_LT(tensor_rel_error(y_ref, y), 1e-7);
  PINF("Consistent with expected results");
}

TEST_F(LayerConvTest, Forward){
  conv_param_t conv_params;

  conv_params.stride=2;
  conv_params.padding=1;

  uint nr_img = 2;
  uint sz_img = 4;
  uint nr_in_channel = 3;
  uint sz_filter = 4;
  uint nr_filter = 3;

  uint sz_out = 1 + (sz_img + 2 * conv_params.padding - sz_filter) / conv_params.stride;
  EXPECT_EQ(2, sz_out);

  uint const shape_x[] = {nr_img, nr_in_channel, sz_img, sz_img}; // 2x3x4x4
  uint const shape_w[] = {nr_filter, nr_in_channel, sz_filter, sz_filter}; // 3x3x4x4
  uint const shape_y[] = {nr_img, nr_filter, sz_out, sz_out}; // 2x3x2x2

  tensor_t x = tensor_make_linspace(-0.1, 0.5, shape_x, dim_of_shape(shape_x));
  tensor_t w = tensor_make_linspace(-0.2, 0.3, shape_w, dim_of_shape(shape_w));
  tensor_t y = tensor_make(shape_y, dim_of_shape(shape_y));

  lcache_t cache;
  make_empty_lcache(&cache);

  status_t ret = convolution_forward(x, w, &cache, conv_params, y);// forward function should allocate and populate cache;
  EXPECT_EQ(ret, S_OK);
  tensor_dump(y);

  tensor_t y_ref = tensor_make_alike(y);
  T value_list[] =  {0.012401913875598115, -0.009877806404122181, -0.08387191755612806, -0.11092160471107837, 0.16027088700772907, 0.166610967979389, 0.17847626058152372, 0.1800463746779536, 0.30813986013986006, 0.3430997423629002, 0.4408244387191755, 0.47101435406698555, -0.8805358851674642, -0.9314354066985646, -1.0912889216047112, -1.1469584100110415, 0.6410835480309163, 0.618803827751196, 0.5448097165991902, 0.5177600294442398, 2.162702981229297, 2.1690430622009567, 2.1809083548030914, 2.1824784688995216};

  tensor_fill_list(y_ref, value_list, array_size(value_list));

  EXPECT_LT(tensor_rel_error(y_ref, y), 1e-7);
  PINF("Consistent with expected results");
}

TEST_F(LayerConvTest, DISABLED_Backward){
  conv_param_t params;

  params.stride=2;
  params.padding=1;

  uint nr_img = 2;
  uint sz_img = 4;
  uint nr_in_channel = 3;
  uint sz_filter = 4;
  uint nr_filter = 3;

  uint sz_out = 1 + (sz_img + 2 * params.padding - sz_filter) / params.stride;
  EXPECT_EQ(2, sz_out);

  uint const shape_x[] = {nr_img, nr_in_channel, sz_img, sz_img}; // 2x3x4x4
  uint const shape_w[] = {nr_filter, nr_in_channel, sz_filter, sz_filter}; // 3x3x4x4
  uint const shape_y[] = {nr_img, nr_filter, sz_out, sz_out}; // 2x3x2x2

  tensor_t x = tensor_make_linspace(-0.1, 0.5, shape_x, dim_of_shape(shape_x));
  tensor_t w = tensor_make_linspace(-0.2, 0.3, shape_w, dim_of_shape(shape_w));
  tensor_t y = tensor_make(shape_y, dim_of_shape(shape_y));

  lcache_t cache;
  make_empty_lcache(&cache);

  status_t ret = convolution_forward(x, w, &cache, params, y);// forward function should allocate and populate cache;
  EXPECT_EQ(ret, S_OK);

  // input for backward
  tensor_t dy = tensor_make_linspace(-0.1, 0.5, shape_y, dim_of_shape(shape_y));

  tensor_t dx = tensor_make_alike(x);
  tensor_t dw = tensor_make_alike(w);

  ret = convolution_backward(dx, dw, &cache, dy); // backward needs to call free_lcache(cache);
  EXPECT_EQ(ret, S_OK);

  /* II. Numerical check */
  // I had to make this copy since lambda doesn't allow me to use global
  // variable
  tensor_t x_copy = tensor_make_copy(x);
  tensor_t w_copy = tensor_make_copy(w);

  tensor_t dx_ref = tensor_make_alike(x);
  tensor_t dw_ref = tensor_make_alike(w);

  // evaluate gradient of x
  eval_numerical_gradient(
      [&](tensor_t const in, tensor_t out) {
        convolution_forward(in, w_copy, NULL, params, out);
      },
      x, dy, dx_ref);
  EXPECT_LT(tensor_rel_error(dx_ref, dx), 1e-7);
  PINF("gradient check of x... is ok");

  // evaluate gradient of w
  eval_numerical_gradient(
      [&](tensor_t const in, tensor_t out) {
        convolution_forward(x_copy, in , NULL, params, out);
      },
      w, dy, dw_ref);
  EXPECT_LT(tensor_rel_error(dw_ref, dw), 1e-7);
  PINF("gradient check of w... is ok");

  EXPECT_EQ(ret, S_OK);
}

// TODO: check with cudnn

TEST_F(LayerConvTest,CheckLcache){
//  EXPECT_EQ(cache.count, 0); // backward needs to pop all all caches and destroy them
}



TEST_F(LayerConvTest, Destroy) {
//  tensor_destroy(x);
//  tensor_destroy(w);
//  lcache_free_all(&cache);
}


}  // namespace

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
